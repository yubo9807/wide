import{a as S,L as T,b as R}from"./page-access.8950e182.js";import{u as N,a as z}from"./vue-router.66467d2c.js";import{e as E,b as L,g as V,h as P}from"./utils.0f533082.js";import{v as $,p as q,n as H,I as O,ar as g,o as _,S as w,T as d,h as t,g as k,F as I,ah as M,O as B,Y as u,Z as C,X as b,a2 as J,aQ as K,aR as Q}from"./vue-1679627021.a934d265.js";import{r as j,_ as A}from"./layout.0f849ecc.js";import{c as U,b as W}from"./element-plus.1d80007c.js";function X(){return j({url:"/memory/redis",method:"get"})}function Y(){return j({url:"/memory/redis",method:"delete"})}const Z=()=>{const e=H(),s=N(),i=z(),f=$([]);m();async function m(){const{log:n}=i.query,[p,c]=await S({path:"/"});if(p)return;const r=c.data.reverse();f.value=r,s.replace({query:{log:n||r[0].name}});const F=r.find(h=>h.name===n);o(F?F.path:r[0].path)}const y=$({});async function o(n){const[p,c]=await S({path:n}),{data:r}=c;y.value=r,s.replace({query:{log:r.name}}),l()}function l(){setTimeout(()=>{const n=e.refs.content;n.scrollTo({top:n.scrollHeight,behavior:"smooth"})},0)}const a=$(!0);return q(()=>a.value,n=>{n&&l()}),{fileList:f,fileAttr:y,getFileContent:o,calculateByte:E,newline:a}};const G=O({components:{LayoutContainer:T},setup:Z}),ee={class:"list"},te=["onClick"],ne={class:"wrap"},oe={class:"head"},se={ref:"content",class:"content"};function ae(e,s,i,f,m,y){const o=g("el-link"),l=g("LayoutContainer");return _(),w(l,{class:"logs-page clearfix"},{default:d(()=>[t("ul",ee,[(_(!0),k(I,null,M(e.fileList,(a,n)=>(_(),k("li",{key:n,class:B(e.$route.query.log===a.name?"active":""),onClick:p=>e.getFileContent(a.path)},[t("span",null,u(a.name),1)],10,te))),128))]),t("div",ne,[t("div",oe,[t("span",null,u(e.calculateByte(e.fileAttr.size)),1),C(o,{type:"primary",underline:!1,onClick:s[0]||(s[0]=a=>e.newline=!e.newline)},{default:d(()=>[b("\u81EA\u52A8\u6362\u884C")]),_:1})]),t("div",se,[t("pre",{class:B([e.newline?"newline":""])},u(e.fileAttr.content),3)],512)])]),_:1})}const re=A(G,[["render",ae],["__scopeId","data-v-c59ad302"]]),Ae=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"})),le={};function ue(e,s){const i=g("router-view");return _(),w(i)}const ie=A(le,[["render",ue]]),Se=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"})),ce=()=>{const e=$([]),s=J({length:0,size:"0Byte"});let i=null;const f=z();q(()=>f.query.path,async o=>{(!i||!o)&&await m(),o&&(e.value=[i.find(l=>l.key===o)])},{immediate:!0});async function m(){const[o,l]=await X();if(o)return;const{data:a,size:n,length:p}=l.data;s.length=p,s.size=E(n);const c=[];for(const r in a){const{createTime:F,overTime:h,count:x,value:D}=a[r];c.push({key:r,createTime:L(F),cacheTime:h===null?1/0:V(h/1e3),overTime:h===null?"-":L(F+h),count:x,value:JSON.stringify(D),size:P(a[r])+r.length})}e.value=c,i=c}function y(){U.confirm("\u786E\u8BA4\u6E05\u7A7A Redis \u7F13\u5B58\uFF1F","\u8B66\u544A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{const[o]=await Y();o||(W.success("\u64CD\u4F5C\u6210\u529F"),m())}).catch(()=>{})}return{table:e,total:s,clearCache:y}},pe=O({components:{LayoutContainer:T,LayoutBothSides:R},setup:ce});const v=e=>(K("data-v-5ea145ff"),e=e(),Q(),e),de={class:"list-wrap"},_e=["onClick"],fe=v(()=>t("strong",null,"Key\uFF1A",-1)),me=v(()=>t("strong",null,"Size\uFF1A",-1)),ye=v(()=>t("strong",null,"\u8FC7\u671F\u65F6\u95F4\uFF1A",-1)),he=v(()=>t("strong",null,"\u7F13\u5B58\u65F6\u95F4\uFF1A",-1)),ge=v(()=>t("strong",null,"Value\uFF1A",-1));function Fe(e,s,i,f,m,y){const o=g("el-link"),l=g("LayoutBothSides"),a=g("LayoutContainer");return _(),w(a,null,{default:d(()=>[C(l,{class:"header",rightWidth:"160px"},{left:d(()=>[t("span",null,"\u5360\u7528\u5185\u5B58\uFF1A"+u(e.total.size),1),t("span",null,"\u6570\u636E\u957F\u5EA6\uFF1A"+u(e.total.length),1)]),right:d(()=>[C(o,{onClick:s[0]||(s[0]=n=>e.$router.replace({query:{}}))},{default:d(()=>[b("\u5168\u90E8\u6570\u636E")]),_:1}),C(o,{onClick:e.clearCache},{default:d(()=>[b("\u6E05\u7A7A\u7F13\u5B58")]),_:1},8,["onClick"])]),_:1}),t("ul",de,[(_(!0),k(I,null,M(e.table,(n,p)=>(_(),k("li",{key:p},[t("p",{class:"key",onClick:c=>e.$router.replace({query:{path:n.key}})},[fe,t("span",null,u(n.key),1)],8,_e),t("p",null,[me,t("span",null,u(n.size)+" Byte",1)]),t("p",null,[ye,t("span",null,u(n.overTime),1)]),t("p",null,[he,t("span",null,u(n.cacheTime),1)]),t("p",{class:B([e.table.length>1?"pack-up":""])},[ge,t("span",null,u(n.value),1)],2)]))),128))])]),_:1})}const ve=A(pe,[["render",Fe],["__scopeId","data-v-5ea145ff"]]),Le=Object.freeze(Object.defineProperty({__proto__:null,default:ve},Symbol.toStringTag,{value:"Module"}));export{X as a,Se as b,Le as c,Ae as i};
