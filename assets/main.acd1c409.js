var ye=Object.defineProperty;var ge=(e,t,n)=>t in e?ye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var T=(e,t,n)=>(ge(e,typeof t!="symbol"?t+"":t,n),n),te=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var k=(e,t,n)=>(te(e,t,"read from private field"),n?n.call(e):t.get(e)),V=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},$=(e,t,n,u)=>(te(e,t,"write to private field"),u?u.call(e,n):t.set(e,n),n);import{ar as s,o as C,S as B,I as he,aq as ne,n as I,g as q,v as h,a2 as j,t as U,p as R,T as a,Z as o,ah as de,F as ce,X as g,a6 as z,ai as O,Y as G,U as oe,_ as le,G as ue,aJ as Ee}from"./vue-1679627298.c4db9afc.js";import{_ as L,b as De}from"./layout.9d4d40c9.js";import{_ as Fe}from"./main.37f9d73a.js";import{c as Ce,b as ve}from"./vue-router.e93c7b34.js";import{T as J,b as W,L as we}from"./page-access.17907827.js";import{o as Ie,E as ke,b as v,a as ae,c as X,l as Le}from"./element-plus.077029b0.js";import{f as Be,i as Te,a as Ve,d as w,I as Y,b as Z}from"./utils.93ae7c0e.js";import"./element-reset.f5779363.js";import"./tools.d490154e.js";const $e={setup(){return document.title="\u6743\u9650\u7BA1\u7406",{}}};function Ae(e,t,n,u,r,b){const f=s("router-view");return C(),B(f)}const Se=L($e,[["render",Ae]]),Me=he({setup(e){const t=I();return()=>ne(ne(Ie,{...e},{...t.slots}))}});const Ne={},Re={class:"table-add-btn"};function Ue(e,t){return C(),q("div",Re,"+")}const Q=L(Ne,[["render",Ue],["__scopeId","data-v-788b5a4d"]]);Be();let H=null;const Pe={baseURL:"http://hicky.hpyyb.cn/permissions",timeout:5e3},x=De.create(Pe);x.interceptors.request.use(e=>(H=ke.service({lock:!0}),e));x.interceptors.response.use(e=>{if(H.close(),e.headers&&e.headers["content-type"].includes("text/html;"))return v.error("\u8BF7\u6C42\u5730\u5740\u9519\u8BEF"),Promise.reject(e);if(e.status===200){const t=e.config,n=e.data;return Te(n)!=="object"||n.code===200?Promise.resolve(n):(console.error(Object.assign(n,{url:t.url})),!t.noTips&&v.error(n.message),Promise.reject(n))}else return Promise.reject(e)},e=>(H.close(),e.response?(!e.config.noTips&&v.error(e.response.data.error),Promise.reject(e.response.data)):(e.config,ae.closeAll(),ae({title:"\u7F51\u7EDC\u53EF\u80FD\u5B58\u5728\u4E00\u4E9B\u95EE\u9898",message:e.message||"\u9519\u8BEF\u539F\u56E0\uFF1A\u7F51\u7EDC\u65AD\u5F00/\u65E0\u6CD5\u8FDE\u63A5/\u7F51\u7EDC\u5DEE/\u8FDE\u63A5\u8D85\u65F6/\u670D\u52A1\u5668\u5FD9\uFF0C\u8BF7\u5C1D\u8BD5\u91CD\u65B0\u64CD\u4F5C\u6216\u5237\u65B0\u9875\u9762",duration:null}),Promise.reject({code:500,msg:e.message||"network error"}))));function D(e){return Ve(x(e))}function qe(){return D({url:"/v1/api/roles/list"})}function re(e){return D({url:"/v1/api/menu/list",method:"get",params:e})}function je(e){return D({url:"/v1/api/menu/add",method:"post",data:e})}function Ke(e){return D({url:"/v1/api/menu/modify",method:"post",data:e})}function ze(e){return D({url:"/v1/api/menu/delete",method:"post",data:e})}function se(e){return D({url:"/v1/api/interface/list",method:"get",params:e})}function He(e){return D({url:"/v1/api/interface/add",method:"post",data:e})}function Oe(e){return D({url:"/v1/api/interface/modify",method:"post",data:e})}function Ge(e){return D({url:"/v1/api/interface/delete",method:"post",data:e})}function ie(e){return D({url:"/v1/api/element/list",method:"get",params:e})}function Je(e){return D({url:"/v1/api/element/add",method:"post",data:e})}function We(e){return D({url:"/v1/api/element/modify",method:"post",data:e})}function Xe(e){return D({url:"/v1/api/element/delete",method:"post",data:e})}function ee(e){return D({url:"/v1/api/correlation/synchronization",method:"post",data:e})}const Ye=()=>{const e=I(),t=e.props,n=h(!1),u=j({name:"",method:"",url:"",menuId:""}),r={name:{required:!0,message:"\u8BF7\u8F93\u5165\u63A5\u53E3\u540D\u79F0",trigger:"blur"},method:{required:!0,message:"\u8BF7\u9009\u62E9\u65B9\u6CD5",trigger:"blur"},url:{required:!0,message:"\u8BF7\u8F93\u5165Url",trigger:"blur"}};async function b(){e.refs.formRef.validate(async l=>{!l||(t.type===0?f():m())})}async function f(){const _=w(u),[l]=await He(_);l||(v.success("\u6DFB\u52A0\u6210\u529F"),n.value=!1,e.emit("success"))}async function m(){const _=w({id:t.need.id,...u}),[l]=await Oe(_);l||(v.success("\u4FEE\u6539\u6210\u529F"),n.value=!1,e.emit("success"))}const y=U("getRoleList"),c=U("getMenuList"),p=h([]),d=h([]);R(()=>n.value,_=>{if(_){if(p.value=y(),d.value=c(),t.type===0&&(u.menuId=t.need.menuId),t.type===1)for(const l in u)u[l]=t.need[l]}else{e.refs.formRef.resetFields();for(const l in u)u[l]=""}});function i(_){u.menuId=_.id}return{visible:n,menuList:d,methodList:[{value:"GET"},{value:"POST"},{value:"PUT"},{value:"DELETE"},{value:"HEAD"},{value:"CONNECT"},{value:"OPTIONS"},{value:"TRACE"},{value:"PATCH"}],form:u,rules:r,submit:b,treeNodeClick:i}},Ze={components:{TwiceDialog:J},props:{type:{type:Number,default:0},need:{type:Object,default:()=>({})}},setup:Ye};function Qe(e,t,n,u,r,b){const f=s("el-input"),m=s("el-form-item"),y=s("el-option"),c=s("el-select"),p=s("el-tree-select"),d=s("el-button"),i=s("el-form"),_=s("TwiceDialog");return C(),B(_,{modelValue:e.visible,"onUpdate:modelValue":t[4]||(t[4]=l=>e.visible=l),width:"400px"},{default:a(()=>[o(i,{ref:"formRef","label-width":"100px",model:e.form,rules:e.rules,"label-position":"left"},{default:a(()=>[o(m,{label:"\u63A5\u53E3\u540D\u79F0",prop:"name"},{default:a(()=>[o(f,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.form.name=l)},null,8,["modelValue"])]),_:1}),o(m,{label:"\u65B9\u6CD5",prop:"method"},{default:a(()=>[o(c,{modelValue:e.form.method,"onUpdate:modelValue":t[1]||(t[1]=l=>e.form.method=l)},{default:a(()=>[(C(!0),q(ce,null,de(e.methodList,(l,F)=>(C(),B(y,{key:F,label:l.value,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"Url",prop:"url"},{default:a(()=>[o(f,{modelValue:e.form.url,"onUpdate:modelValue":t[2]||(t[2]=l=>e.form.url=l)},null,8,["modelValue"])]),_:1}),o(m,{label:"\u7236\u7EA7\u83DC\u5355"},{default:a(()=>[o(p,{modelValue:e.form.menuId,"onUpdate:modelValue":t[3]||(t[3]=l=>e.form.menuId=l),data:e.menuList,clearable:"",props:{children:"children",label:"title",value:"id"},"render-after-expand":!1,disabled:n.type===0,onNodeClick:e.treeNodeClick},null,8,["modelValue","data","disabled","onNodeClick"])]),_:1}),o(m,null,{default:a(()=>[o(d,{type:"primary",onClick:e.submit},{default:a(()=>[g("\u786E\u8BA4")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}const xe=L(Ze,[["render",Qe]]),et={url:""};var A,S;class tt extends Y{constructor(){super(et,se);V(this,A,null);V(this,S,null);T(this,"initData",async()=>{const n=w({roleId:k(this,S).roleId,menuId:k(this,S).menuId,...this.form}),[u,r]=await se(n);if(u)return;this.tableData.value=r.data;const b=k(this,A).refs.tableEl,f=r.data.filter(m=>m.selected);z(()=>{f.forEach(m=>b.toggleRowSelection(m))})});$(this,A,I()),$(this,S,k(this,A).props)}}A=new WeakMap,S=new WeakMap;const nt=()=>{const e=I(),t=e.proxy,n=e.props,u=h(0),r=h({});function b(){u.value=0,r.value={menuId:n.menuId},e.refs.dialogInterface.visible=!0}function f(c){const{id:p,name:d,method:i,url:_,menuId:l}=c;u.value=1,r.value={id:p,name:d,method:i,url:_,menuId:l},e.refs.dialogInterface.visible=!0}function m(c){X.confirm("\u786E\u8BA4\u5220\u9664\u8BE5\u63A5\u53E3","\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{const[p,d]=await Ge({id:c.id});p||(v.success("\u5220\u9664\u6210\u529F"),t.initData())}).catch(()=>{})}async function y(c){const p=c.map(l=>l.id),d=t.tableData.filter(l=>!p.includes(l.id)).map(l=>l.id),i=w({tableType:"interface",roleId:n.roleId,contactIdList:p,deleteIdList:d}),[_]=await ee(i);_||t.initData()}return{dialogInterfaceType:u,dialogInterfaceNeed:r,addInterface:b,modifyInterface:f,deleteInterface:m,select:y}},ot={components:{LayoutSearchHeader:W,TableAddBtn:Q,DialogInterface:xe},props:{roleId:{type:[String,Number],required:!0},menuId:{type:String,default:""}},setup:()=>({dateFormater:Z,...new tt,...nt()})},lt={class:"menu-list"};function ut(e,t,n,u,r,b){const f=s("el-input"),m=s("el-button"),y=s("LayoutSearchHeader"),c=s("el-table-column"),p=s("el-link"),d=s("el-table"),i=s("TableAddBtn"),_=s("DialogInterface");return C(),q("div",lt,[o(y,{class:"reset-search-header-input","right-width":"340px"},{left:a(()=>[o(f,{modelValue:e.form.url,"onUpdate:modelValue":t[0]||(t[0]=l=>e.form.url=l),placeholder:"\u8BF7\u8F93\u5165\u63A5\u53E3\u5730\u5740",onKeyup:O(e.search,["enter"]),onClear:e.search},null,8,["modelValue","onKeyup","onClear"])]),right:a(()=>[o(m,{type:"primary",onClick:e.search},{default:a(()=>[g("\u67E5\u8BE2")]),_:1},8,["onClick"]),o(m,{onClick:e.reset},{default:a(()=>[g("\u91CD\u7F6E")]),_:1},8,["onClick"])]),_:1}),o(d,{ref:"tableEl",data:e.tableData,onSelect:e.select,onSelectAll:e.select},{default:a(()=>[o(c,{type:"selection",width:"40",label:""}),o(c,{type:"index",label:"\u5E8F\u53F7",width:"60"}),o(c,{label:"\u63A5\u53E3\u540D\u79F0",prop:"name"}),o(c,{label:"Method",prop:"method"}),o(c,{label:"Url",prop:"url"}),o(c,{label:"\u66F4\u65B0\u65F6\u95F4"},{default:a(l=>[g(G(e.dateFormater((l.row.updateTime||l.row.createTime)*1e3)),1)]),_:1}),o(c,{label:"\u64CD\u4F5C",fixed:"right",width:"100"},{default:a(l=>[o(p,{onClick:F=>e.modifyInterface(l.row)},{default:a(()=>[g("\u4FEE\u6539")]),_:2},1032,["onClick"]),o(p,{onClick:F=>e.deleteInterface(l.row)},{default:a(()=>[g("\u5220\u9664")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelect","onSelectAll"]),o(i,{onClick:e.addInterface},null,8,["onClick"]),o(_,{ref:"dialogInterface",type:e.dialogInterfaceType,need:e.dialogInterfaceNeed,onSuccess:e.initData},null,8,["type","need","onSuccess"])])}const at=L(ot,[["render",ut]]),rt=()=>{const e=I(),t=e.props,n=h(!1),u=j({name:"",key:"",menuId:""}),r={name:{required:!0,message:"\u8BF7\u8F93\u5165\u63A5\u53E3\u540D\u79F0",trigger:"blur"},key:{required:!0,message:"\u8BF7\u8F93\u5165Key",trigger:"blur"}};async function b(){e.refs.formRef.validate(async l=>{!l||(t.type===0?f():m())})}async function f(){const _=w(u),[l]=await Je(_);l||(v.success("\u6DFB\u52A0\u6210\u529F"),n.value=!1,e.emit("success"))}async function m(){const _=w({id:t.need.id,...u}),[l]=await We(_);l||(v.success("\u4FEE\u6539\u6210\u529F"),n.value=!1,e.emit("success"))}const y=U("getRoleList"),c=U("getMenuList"),p=h([]),d=h([]);R(()=>n.value,_=>{if(_){if(p.value=y(),d.value=c(),t.type===0&&(u.menuId=t.need.menuId),t.type===1)for(const l in u)u[l]=t.need[l]}else{e.refs.formRef.resetFields();for(const l in u)u[l]=""}});function i(_){u.menuId=_.id}return{visible:n,menuList:d,form:u,rules:r,submit:b,treeNodeClick:i}},st={components:{TwiceDialog:J},props:{type:{type:Number,default:0},need:{type:Object,default:()=>({})}},setup:rt};function it(e,t,n,u,r,b){const f=s("el-input"),m=s("el-form-item"),y=s("el-tree-select"),c=s("el-button"),p=s("el-form"),d=s("TwiceDialog");return C(),B(d,{modelValue:e.visible,"onUpdate:modelValue":t[3]||(t[3]=i=>e.visible=i),width:"400px"},{default:a(()=>[o(p,{ref:"formRef","label-width":"100px",model:e.form,rules:e.rules,"label-position":"left"},{default:a(()=>[o(m,{label:"\u5143\u7D20\u540D\u79F0",prop:"name"},{default:a(()=>[o(f,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=i=>e.form.name=i)},null,8,["modelValue"])]),_:1}),o(m,{label:"Key",prop:"key"},{default:a(()=>[o(f,{modelValue:e.form.key,"onUpdate:modelValue":t[1]||(t[1]=i=>e.form.key=i)},null,8,["modelValue"])]),_:1}),o(m,{label:"\u7236\u7EA7\u83DC\u5355"},{default:a(()=>[o(y,{modelValue:e.form.menuId,"onUpdate:modelValue":t[2]||(t[2]=i=>e.form.menuId=i),data:e.menuList,clearable:"",props:{children:"children",label:"title",value:"id"},"render-after-expand":!1,disabled:n.type===0,onNodeClick:e.treeNodeClick},null,8,["modelValue","data","disabled","onNodeClick"])]),_:1}),o(m,null,{default:a(()=>[o(c,{type:"primary",onClick:e.submit},{default:a(()=>[g("\u786E\u8BA4")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}const dt=L(st,[["render",it]]),ct={name:""};var M,N;class mt extends Y{constructor(){super(ct,ie);V(this,M,null);V(this,N,null);T(this,"initData",async()=>{const n=w({roleId:k(this,N).roleId,menuId:k(this,N).menuId,...this.form}),[u,r]=await ie(n);if(u)return;this.tableData.value=r.data;const b=k(this,M).refs.tableEl,f=r.data.filter(m=>m.selected);z(()=>{f.forEach(m=>b.toggleRowSelection(m))})});$(this,M,I()),$(this,N,k(this,M).props)}}M=new WeakMap,N=new WeakMap;const pt=()=>{const e=I(),t=e.proxy,n=e.props,u=h(0),r=h({});function b(){u.value=0,r.value={menuId:n.menuId},e.refs.dialogElement.visible=!0}function f(c){const{id:p,name:d,key:i,menuId:_}=c;u.value=1,r.value={id:p,name:d,key:i,menuId:_},e.refs.dialogElement.visible=!0}function m(c){X.confirm("\u786E\u8BA4\u5220\u9664\u8BE5\u5143\u7D20","\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{const[p,d]=await Xe({id:c.id});p||(v.success("\u5220\u9664\u6210\u529F"),t.initData())}).catch(()=>{})}async function y(c){const p=c.map(l=>l.id),d=t.tableData.filter(l=>!p.includes(l.id)).map(l=>l.id),i=w({tableType:"element",roleId:n.roleId,contactIdList:p,deleteIdList:d}),[_]=await ee(i);_||t.initData()}return{dialogElementType:u,dialogElementNeed:r,addElement:b,modifyElement:f,deleteElement:m,select:y}},ft={components:{LayoutSearchHeader:W,TableAddBtn:Q,DialogElement:dt},props:{roleId:{type:[String,Number],required:!0},menuId:{type:String,default:""}},setup:()=>({dateFormater:Z,...new mt,...pt()})},_t={class:"element-list"};function bt(e,t,n,u,r,b){const f=s("el-input"),m=s("el-button"),y=s("LayoutSearchHeader"),c=s("el-table-column"),p=s("el-link"),d=s("el-table"),i=s("TableAddBtn"),_=s("DialogElement");return C(),q("div",_t,[o(y,{class:"reset-search-header-input","right-width":"340px"},{left:a(()=>[o(f,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.form.name=l),placeholder:"\u8BF7\u8F93\u5165\u5143\u7D20\u540D\u79F0",onKeyup:O(e.search,["enter"]),onClear:e.search},null,8,["modelValue","onKeyup","onClear"])]),right:a(()=>[o(m,{type:"primary",onClick:e.search},{default:a(()=>[g("\u67E5\u8BE2")]),_:1},8,["onClick"]),o(m,{onClick:e.reset},{default:a(()=>[g("\u91CD\u7F6E")]),_:1},8,["onClick"])]),_:1}),o(d,{ref:"tableEl",data:e.tableData,onSelect:e.select,onSelectAll:e.select},{default:a(()=>[o(c,{type:"selection",width:"40",label:""}),o(c,{type:"index",label:"\u5E8F\u53F7",width:"60"}),o(c,{label:"\u5143\u7D20\u540D\u79F0",prop:"name"}),o(c,{label:"Key",prop:"key"}),o(c,{label:"\u66F4\u65B0\u65F6\u95F4"},{default:a(l=>[g(G(e.dateFormater((l.row.updateTime||l.row.createTime)*1e3)),1)]),_:1}),o(c,{label:"\u64CD\u4F5C",fixed:"right",width:"100"},{default:a(l=>[o(p,{onClick:F=>e.modifyElement(l.row)},{default:a(()=>[g("\u4FEE\u6539")]),_:2},1032,["onClick"]),o(p,{onClick:F=>e.deleteElement(l.row)},{default:a(()=>[g("\u5220\u9664")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelect","onSelectAll"]),o(i,{onClick:e.addElement},null,8,["onClick"]),o(_,{ref:"dialogElement",type:e.dialogElementType,need:e.dialogElementNeed,onSuccess:e.initData},null,8,["type","need","onSuccess"])])}const yt=L(ft,[["render",bt]]),gt=()=>{const e=I(),t=h(!1),n=h(0),u={0:"interfaceListRef",1:"elementListRef"};return R(()=>t.value,r=>{r&&z(()=>{e.refs[u[n.value]].initData()})}),R(()=>n.value,r=>{e.refs[u[r]].initData()}),{visible:t,selectType:n}},ht={components:{TwiceDrawer:Me,InterfaceList:at,ElementList:yt},props:{roleId:{type:[String,Number],required:!0},menuId:{type:String,default:""}},setup:gt};function Et(e,t,n,u,r,b){const f=s("el-radio"),m=s("el-radio-group"),y=s("InterfaceList"),c=s("ElementList"),p=s("TwiceDrawer");return C(),B(p,{modelValue:e.visible,"onUpdate:modelValue":t[1]||(t[1]=d=>e.visible=d),size:"80%"},{default:a(()=>[o(m,{modelValue:e.selectType,"onUpdate:modelValue":t[0]||(t[0]=d=>e.selectType=d),class:"ml-4"},{default:a(()=>[o(f,{label:0},{default:a(()=>[g("\u63A5\u53E3")]),_:1}),o(f,{label:1},{default:a(()=>[g("\u5143\u7D20")]),_:1})]),_:1},8,["modelValue"]),oe(o(y,{ref:"interfaceListRef",roleId:n.roleId,menuId:n.menuId},null,8,["roleId","menuId"]),[[le,e.selectType===0]]),oe(o(c,{ref:"elementListRef",roleId:n.roleId,menuId:n.menuId},null,8,["roleId","menuId"]),[[le,e.selectType===1]])]),_:1},8,["modelValue"])}const Dt=L(ht,[["render",Et]]),Ft=()=>{const e=I(),t=e.props,n=h(!1),u=h([]),r=j({name:"",title:"",parent:""}),b={title:{required:!0,message:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",trigger:"blur"},name:{required:!0,message:"\u8BF7\u8F93\u5165Name",trigger:"blur"}};async function f(){e.refs.formRef.validate(async i=>{!i||(t.type===0?m():y())})}async function m(){const d=w(r),[i]=await je(d);i||(n.value=!1,v.success("\u6DFB\u52A0\u6210\u529F"),e.emit("success"))}async function y(){const d=w({id:t.need.id,...r}),[i]=await Ke(d);i||(n.value=!1,v.success("\u4FEE\u6539\u6210\u529F"),e.emit("success"))}const c=U("getMenuList");R(()=>n.value,d=>{if(d){if(u.value=c(),t.type===1)for(const i in r)r[i]=t.need[i]}else{e.refs.formRef.resetFields();for(const i in r)r[i]=""}});function p(d){r.parent=d.id}return{visible:n,menuList:u,form:r,rules:b,submit:f,treeNodeClick:p}},Ct={components:{TwiceDialog:J},props:{type:{type:Number,default:0},need:{type:Object,default:()=>({})}},setup:Ft};function vt(e,t,n,u,r,b){const f=s("el-input"),m=s("el-form-item"),y=s("el-tree-select"),c=s("el-button"),p=s("el-form"),d=s("TwiceDialog");return C(),B(d,{modelValue:e.visible,"onUpdate:modelValue":t[3]||(t[3]=i=>e.visible=i),width:"400px"},{default:a(()=>[o(p,{ref:"formRef","label-width":"100px",model:e.form,rules:e.rules,"label-position":"left"},{default:a(()=>[o(m,{label:"\u83DC\u5355\u540D\u79F0",prop:"title"},{default:a(()=>[o(f,{modelValue:e.form.title,"onUpdate:modelValue":t[0]||(t[0]=i=>e.form.title=i)},null,8,["modelValue"])]),_:1}),o(m,{label:"Name",prop:"name"},{default:a(()=>[o(f,{modelValue:e.form.name,"onUpdate:modelValue":t[1]||(t[1]=i=>e.form.name=i),placeholder:"\u4FDD\u8BC1\u552F\u4E00\uFF0C\u5BF9\u5E94\u524D\u7AEF\u8DEF\u7531\u8BBE\u7F6E name"},null,8,["modelValue"])]),_:1}),o(m,{label:"\u7236\u7EA7\u83DC\u5355"},{default:a(()=>[o(y,{modelValue:e.form.parent,"onUpdate:modelValue":t[2]||(t[2]=i=>e.form.parent=i),data:e.menuList,clearable:"",props:{children:"children",label:"title",value:"id"},"render-after-expand":!1,onNodeClick:e.treeNodeClick},null,8,["modelValue","data","onNodeClick"])]),_:1}),o(m,null,{default:a(()=>[o(c,{type:"primary",onClick:e.submit},{default:a(()=>[g("\u786E\u8BA4")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}const wt=L(Ct,[["render",vt]]),It={name:"",title:""};var P;class kt extends Y{constructor(){super(It,re);V(this,P,null);T(this,"nowRole",j({role:"",id:""}));T(this,"roleList",h([]));T(this,"flatData",h([]));T(this,"initData",async()=>{const n=w({roleId:this.nowRole.id,...this.form}),[u,r]=await re(n);if(u)return;const b=me(r.data);this.flatData.value=r.data,this.tableData.value=b,z(()=>{const f=k(this,P).refs.tableEl;pe(this.tableData.value,f)})});$(this,P,I());const n=this;(async function(){const[u,r]=await qe();if(u)return;const b=r.data;n.roleList.value=b,n.nowRole.role=b[0].role,n.nowRole.id=b[0].id})(),R(()=>this.nowRole.id,u=>{this.initData()}),ue("getRoleList",()=>this.roleList.value),ue("getMenuList",()=>this.tableData.value)}}P=new WeakMap;function me(e,t=null){const n=[],u=[];return e.forEach(r=>{r.parent===t?n.push(r):u.push(r)}),e.forEach(r=>{r.parent===t&&(r.children=me(u,r.id))}),n}function pe(e,t){e.forEach(n=>{t.toggleRowSelection(n,n.selected),n.children&&n.children.length>0&&n.children.map(u=>{pe(n.children,t)})})}const Lt=()=>{const e=I(),t=e.proxy,n=j({name:"",id:""});function u(p={}){n.name=p.name,n.id=p.id,e.refs.drawerConfig.visible=!0}const r=h(0),b=h({});function f(){r.value=0,b.value={},e.refs.dialogMenu.visible=!0}function m(p){const{id:d,name:i,title:_,parent:l}=p;r.value=1,b.value={id:d,name:i,title:_,parent:l},e.refs.dialogMenu.visible=!0}function y(p){X.confirm("\u786E\u8BA4\u5220\u9664\u8BE5\u7528\u6237\uFF1F\u5220\u9664\u540E\u914D\u7F6E\u4E2D\u7684\u63A5\u53E3/\u5143\u7D20\u4F1A\u5F52\u7C7B\u5230\u516C\u5171\u914D\u7F6E\u4E2D\uFF01","\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{const[d,i]=await ze({id:p.id});d||(v.success("\u5220\u9664\u6210\u529F"),t.initData())}).catch(()=>{})}async function c(p){const d=p.map(F=>F.id),i=t.flatData.filter(F=>!d.includes(F.id)).map(F=>F.id),_={tableType:"menu",roleId:t.nowRole.id,contactIdList:d,deleteIdList:i},[l]=await ee(_);l||t.initData()}return{selectMenu:n,showConfig:u,dialogMenuType:r,dialogMenuNeed:b,addMenu:f,modifyMenu:m,deleteMenu:y,select:c}},Bt={components:{LayoutContainer:we,LayoutSearch:W,DrawerConfig:Dt,TableAddBtn:Q,DialogMenu:wt},setup(){return{dateFormater:Z,...new kt,...Lt()}}};function Tt(e,t,n,u,r,b){const f=s("el-option"),m=s("el-select"),y=s("el-input"),c=s("el-button"),p=s("LayoutSearch"),d=s("el-table-column"),i=s("el-link"),_=s("el-table"),l=s("TableAddBtn"),F=s("el-pagination"),fe=s("DrawerConfig"),_e=s("DialogMenu"),be=s("LayoutContainer");return C(),B(be,null,{default:a(()=>[o(p,{class:"reset-search-header-input","right-width":"430px"},{left:a(()=>[o(m,{modelValue:e.nowRole.id,"onUpdate:modelValue":t[0]||(t[0]=E=>e.nowRole.id=E)},{default:a(()=>[(C(!0),q(ce,null,de(e.roleList,(E,K)=>(C(),B(f,{key:K,label:E.role,value:E.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o(y,{modelValue:e.form.title,"onUpdate:modelValue":t[1]||(t[1]=E=>e.form.title=E),class:"input",placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",onKeyup:O(e.search,["enter"]),onClear:e.search},null,8,["modelValue","onKeyup","onClear"])]),right:a(()=>[o(c,{type:"primary",onClick:e.search},{default:a(()=>[g("\u67E5\u8BE2")]),_:1},8,["onClick"]),o(c,{onClick:e.reset},{default:a(()=>[g("\u91CD\u7F6E")]),_:1},8,["onClick"]),o(c,{type:"primary"},{default:a(()=>[g("\u89D2\u8272\u7BA1\u7406")]),_:1}),o(c,{type:"primary",onClick:t[2]||(t[2]=E=>e.showConfig())},{default:a(()=>[g("\u516C\u5171\u914D\u7F6E")]),_:1})]),_:1}),o(_,{ref:"tableEl",data:e.tableData,"row-key":"id","default-expand-all":"","tree-props":{children:"children"},onSelect:e.select,onSelectAll:e.select},{default:a(()=>[o(d,{type:"selection",width:"40",label:""}),o(d,{type:"index",label:"\u5E8F\u53F7",width:"60"}),o(d,{label:"\u83DC\u5355\u540D\u79F0",prop:"title"}),o(d,{label:"Name",prop:"name"}),o(d,{label:"\u66F4\u65B0\u65F6\u95F4"},{default:a(E=>[g(G(u.dateFormater((E.row.updateTime||E.row.createTime)*1e3)),1)]),_:1}),o(d,{label:"\u64CD\u4F5C",fixed:"right",width:"140"},{default:a(E=>[o(i,{onClick:K=>e.showConfig(E.row)},{default:a(()=>[g("\u914D\u7F6E")]),_:2},1032,["onClick"]),o(i,{onClick:K=>e.modifyMenu(E.row)},{default:a(()=>[g("\u4FEE\u6539")]),_:2},1032,["onClick"]),o(i,{onClick:K=>e.deleteMenu(E.row)},{default:a(()=>[g("\u5220\u9664")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelect","onSelectAll"]),o(l,{onClick:e.addMenu},null,8,["onClick"]),o(F,{"default-current-page":e.paging.pageNumber,"default-page-size":e.paging.pageSize,total:e.paging.total,onCurrentChange:e.onCurrentChange,onSizeChange:e.onSizeChange},null,8,["default-current-page","default-page-size","total","onCurrentChange","onSizeChange"]),o(fe,{ref:"drawerConfig",roleId:e.nowRole.id,menuId:e.selectMenu.id},null,8,["roleId","menuId"]),o(_e,{ref:"dialogMenu",type:e.dialogMenuType,need:e.dialogMenuNeed,onSuccess:e.initData},null,8,["type","need","onSuccess"])]),_:1})}const Vt=L(Bt,[["render",Tt]]),$t=[{path:"/",name:"Permissions",component:Vt},{path:"/:pathMatch(.*)*",name:"NotFound",component:Fe(()=>import("./index.d12b57f8.js"),["assets/index.d12b57f8.js","assets/layout.9d4d40c9.js","assets/vue-1679627298.c4db9afc.js","assets/vue-router.e93c7b34.js","assets/utils.93ae7c0e.js","assets/element-plus.077029b0.js","assets/tools.d490154e.js","assets/element-plus.cbc2892a.css","assets/layout.385f7e54.css","assets/index.ecc7842b.css"])}],At=Ce({history:ve("/wide/permissions"),routes:$t});const St=Ee(Se).use(At).use(Le);St.mount("#app");
